{% extends "base.html" %}

{% block title %}Dashboard - Student Portal{% endblock %}

{% block content %}

<div class="welcome card">
    <h2>Welcome, {{ student_name }}!</h2>
    <p><strong>Student ID:</strong> {{ session.get('student_code', 'N/A') }}</p>
    <p>Manage your academic journey with our comprehensive student portal.</p>
</div>


<div class="dashboard-cards">
    <div class="dashboard-card">
        <h3>ğŸ“Š My Profile</h3>
        <p>View and update your personal information</p>
        <a href="{{ url_for('profile') }}" class="btn">View Profile</a>
    </div>
    
    <div class="dashboard-card">
        <h3>ğŸ“š Course Registration</h3>
        <p>Browse and register for courses</p>
        <a href="{{ url_for('courses') }}" class="btn">Register Courses</a>
    </div>
    
    <div class="dashboard-card">
        <h3>ğŸ“ Academic Grades</h3>
        <p>Check your grades and academic history</p>
        <a href="{{ url_for('grades') }}" class="btn">View Grades</a>
    </div>
    
    <div class="dashboard-card">
        <h3>ğŸ“¢ Announcements</h3>
        <p>Latest news from the university</p>
        <a href="{{ url_for('announcements') }}" class="btn">View Announcements</a>
    </div>
</div>


<div class="card">
    <h3>ğŸ“¢ Recent Announcements</h3>
    {% if announcements %}
        <div class="dashboard-announcements">
            {% for announcement in announcements[:3] %}
            <div class="dashboard-announcement {% if announcement.is_important %}dashboard-important{% endif %}">
                <h4>{{ announcement.title }}</h4>
                <p>{{ announcement.content[:100] }}{% if announcement.content|length > 100 %}...{% endif %}</p>
                <div class="announcement-meta">
                    <span>{{ announcement.created_at.strftime('%b %d') }}</span>
                    {% if announcement.is_important %}
                    <span class="important-tag">Important</span>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
        <div style="text-align: center; margin-top: 15px;">
            <a href="{{ url_for('announcements') }}" class="btn">View All Announcements</a>
        </div>
    <!-- Add this card to the dashboard after the announcements card -->
<div class="card">
    <h3>ğŸ“… Today's Classes</h3>
    {% set today = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'] %}
    {% set today_name = today[now().weekday()] if now else 'Monday' %}
    
    <p><strong>Today is {{ today_name }}</strong></p>
    
    {% if timetable_data %}
        {% set todays_classes = [] %}
        {% for course in timetable_data %}
            {% if today_name in course.schedule_days %}
                {% set _ = todays_classes.append(course) %}
            {% endif %}
        {% endfor %}
        
        {% if todays_classes %}
            <div style="margin-top: 15px;">
                {% for course in todays_classes %}
                <div style="background: #f7fafc; padding: 12px; border-radius: 8px; margin-bottom: 10px;">
                    <strong>{{ course.course_code }}</strong> - {{ course.course_name }}<br>
                    <small>â° {{ course.schedule_time }} | ğŸ  {{ course.room_number }}</small>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <p>No classes scheduled for today.</p>
        {% endif %}
    {% else %}
        <p>No timetable data available.</p>
    {% endif %}
    
    <div style="text-align: center; margin-top: 15px;">
        <a href="{{ url_for('timetable') }}" class="btn">View Full Timetable</a>
    </div>
</div>
    {% else %}
        <p>No recent announcements.</p>
    {% endif %}
</div>


{% endblock %}
